create database omniventSample;

use omniventSample;

create table PDV_VENTA(
	vta_id int not null primary key,
	vta_folio_venta int not null,
	vta_fecha datetime not null,
	vta_total money not null,
	vta_estatus char(1) not null,
	sucursal varchar(100) not null,
	vendedor varchar(30) null,
	lista_precios varchar(30) null	
);

-- Tabla GLB_PRODUCTO
-- con join a la tabla PDV_LISTAP_DETALLE
-- PDV_LISTA_PRECIO

CREATE TABLE GLB_PRODUCTO(
	[pro_id] [int] NOT NULL primary key,
	[pro_descripcion] [varchar](60) NOT NULL,
	[pro_codigo_barras] [varchar](20) NULL,
	[pro_identificacion] [varchar](20) NULL,
	[fam_descripcion] [varchar](50) NOT NULL,
	[sub_descripcion] [varchar](60) NOT NULL,
	[pro_precio_general_iva] [money] NOT NULL,
	[pro_costo_general_iva] [money] NOT NULL
);

CREATE TABLE PDV_LISTA_PRECIO(
	[lip_id] [int] not null primary key,
	[lip_nombre] [varchar](30) NOT NULL
);

CREATE TABLE [dbo].[PDV_LISTAP_DETALLE](
	[num_lipd] [int] NOT NULL IDENTITY primary key,
	[lip_id] [int] NOT NULL,
	[pro_id] [int] NOT NULL,
	[lpd_precio_sin_iva] [money] NOT NULL,
	[lpd_precio_con_iva] [money] NOT NULL,
	FOREIGN KEY (lip_id) REFERENCES PDV_LISTA_PRECIO(lip_id),
	FOREIGN KEY (pro_id) REFERENCES GLB_PRODUCTO(pro_id)
);

--Tabla GLB_PERFIL
create table GLB_PERFIL(
	idrol integer primary key identity,
	nombre varchar(30) not null,
	descripcion varchar(100) null,
	condicion bit default(1)
);

--Tabla GLB_USUARIO
create table GLB_USUARIO(
	idusuario integer primary key identity,
	idrol integer not null,
	usuario varchar(100) not null,
	password_hash varbinary(MAX) not null,
	password_salt varbinary(MAX) not null,
	condicion bit default(1),
	FOREIGN KEY (idrol) REFERENCES GLB_PERFIL(idrol)
);

SET IDENTITY_INSERT [dbo].[GLB_PERFIL] ON
INSERT INTO [dbo].[GLB_PERFIL] ([idrol], [nombre], [descripcion], [condicion]) VALUES (1, N'super', N'Acceso a toda la API', 1);
INSERT INTO [dbo].[GLB_PERFIL] ([idrol], [nombre], [descripcion], [condicion]) VALUES (2, N'administrador', N'Todos los permisos', 1);
INSERT INTO [dbo].[GLB_PERFIL] ([idrol], [nombre], [descripcion], [condicion]) VALUES (3, N'consultor', N'Permisos de Vista', 1);
SET IDENTITY_INSERT [dbo].[GLB_PERFIL] OFF

INSERT INTO [dbo].[PDV_VENTA] ([vta_id], [vta_folio_venta], [vta_fecha], [vta_total], [vta_estatus], [sucursal], [vendedor], [lista_precios]) VALUES (2, 1, N'1998-08-25 00:00:00', CAST(100.0000 AS Money), N'1', N'Plan de Ayala 18, Lázaro Cárdenas, 61516 Zitácuaro, Mich.', N'José Pablo Barraza', N'JUGUETES1');
INSERT INTO [dbo].[PDV_VENTA] ([vta_id], [vta_folio_venta], [vta_fecha], [vta_total], [vta_estatus], [sucursal], [vendedor], [lista_precios]) VALUES (1003, 3, N'2010-10-23 00:00:00', CAST(500.0000 AS Money), N'0', N'Crisantemo Oriente 7, El Moral, 61514 Zitácuaro, Mich.', N'José Rodrigo Hernández', N'COMESTIBLES2');
INSERT INTO [dbo].[PDV_VENTA] ([vta_id], [vta_folio_venta], [vta_fecha], [vta_total], [vta_estatus], [sucursal], [vendedor], [lista_precios]) VALUES (1004, 2, N'2020-03-30 00:00:00', CAST(316.0000 AS Money), N'1', N'Fco. Montes de Oca Sur, El Moral, 61514 Zitácuaro, Mich.', N'David Heredia', N'MISCELANEOS005');

SET IDENTITY_INSERT [dbo].[GLB_USUARIO] ON 
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (3, 1, N'omni-user', 0x9738C8CE3311893E4854AE0939170FF78C31C5C836672CE8B2B6158E73EECFECAC7E7ECA359A6892E6134CF7E91CE569AF2B33FDAB45A7574A20E6D0D6048E14, 0x147BC5231DA4A726F6C2E98379A9FD139B1E339DFEED8D7F3C362325B642CF2B128ED6AA43FEFF8B470F789B74FB20A0FC0916A49B73013E6EBB750BB4E98E5A7BB1B1EABCD3CE821A7254D0AEE6AAB2328CF97C8D95F9B801493917935DA2E3B983A4B41D673647C06B15C7ED32393C01924DCEFE972E955C6043C2C617EF19, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (4, 2, N'admin', 0x5412E8BAB939E7F09BED7B87640285F911FA38427F7ED483D249EED0352FA36E5792EAD8E4A2DAE517B5C8138E939DA76F92CEB2CCFD9C652A6BC3BF66149DA8, 0x90C42C8105872C471E1ACD5E1E00B0AECEF885BA508171AD070CB2D37105E2EBDF56DFEB65B236CDFCB6DEBC37199F5107B165C251D7467A59E25B040D7AD84A471A5736288376052F47B495405E8FC4918A53F4F069849EB78237EE95C4C83D24F73DF971435410697A14D45696C09B0F6D2BB90D4804F55E772B638F6622DA, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (5, 3, N'consultor1', 0x1B71989354A4E97C8A962F1A150A7EF31D408C36D261559517E1656D6B4FD4F4186AE959C26AFE20DEFE42225FE31D4C026073E9714732B112FF7670BC66AFCD, 0xD06E161DCFC8C8C10C1CC395A2DA8FBE19F76388EB0F60A630DC2C084749775B6C3BEF9B22171B9D6956022F9552A67C5D04251E166200E9808C4217787360FC05B108045AD5CB842DDE3D68A68B1D7BA1029480F17CC1DBD7A766D9971A1316C040593020DEC7B95D0DCAEBD1FB5ED22F909B3A85D8AC51EFC420E3B35FA92B, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (6, 3, N'consultor2', 0xF4585542AA9B0D2B647536171608A52D21F1D964C0083EB83FE7E8BFF2FA4C09A666AE8EE32F05D6D0E54292DFE30C10F39E0720060EA04D18A192D53A5AEFF0, 0x2E60826F974185AC466F59BF6E8D1ACC580005E8AEF3047C3C4B1E2941337BE7C5355FB54B9153D85CA7ABFEB67A9A42B5C1BC0E93B4396D8F07F34306E6CE1F3DD6229BD9253EBBF99525AAA604F32A9DDA3CFCBB72C90A9552449C429950A8763E0473EE8055620FEE7BBAA3490E61C785B811C7EDBFE014B5373DCACFE200, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (7, 3, N'consultor3', 0xEC1F7B070FC9CBB852241B570906B6395392BEEBDF841AF8E7CDEB11B2F7F9250307A5BE758C15AFA3B26D2D2BE497909BE94D2BA0BF9ECC76F7E424F3116A53, 0x8DE8AEC312A001B62FF8C9A2B0DEB49E28CFD17764AB760C9A642A87512CB0B438523112AA237B51D771CE7D12CE22BDA0F0863C542719E96F20F76960FBF7CCF10B4E39D16ABF43D2B94E79DE814FA10595D81E3AD975897744F72F9B632E0FFEEE0B424A901E8D7F88CE95AB7D2CBE23681E998BA0F8C00A23C5C18FC1A5DA, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (8, 3, N'consultor4', 0xF8B119C8B2262D97C55A17B7E77DCC8189881020A3344FEF78E0DDCC3813DB8383C168858654CFB5B71902C1F3CCDA6496571761E84507A31119B41E0B30C384, 0xBEA1649AF2C9C9FACAE208D01860E4BC0C4A1A3BCCF6F05728136973E69AD05ECF1906BFBF6FDAEDEF27FB29034444883F3678B624ABF9BBC1215C3E204234651F17432576377A4A3881ECEA67435ED120157C12B533D5F352DC69635462A1034811B3525E13EB630589E9F818313291314DCC45BFCE330A00AB011ACB4F5F13, 1)
INSERT [dbo].[GLB_USUARIO] ([idusuario], [idrol], [usuario], [password_hash], [password_salt], [condicion]) VALUES (9, 3, N'consultor5', 0xB80FD786677E37BAB0A1F3102C2E38B4BB0E408D02EECC119276164D9574AC9832D4FA8961998C60736FD402DA980DD16971FBEF4143FA96A631AE3C455BC6D4, 0x0EA054EA786544D476E21E0D664BB891CC6AFF47FEF7DB657B3287A4BF212215BA48B12918714BC0C26A6D597C46E0158644A562F5F966837276E68BC419EA857E0210525700BE8AC107CE7A6F8631CF42CEFEAC989AFC27AF043B17152A755E7DFAF98554A855436543BC5633D652C670C443BB7FF0CD0BBEDADDD1202BC294, 1)
SET IDENTITY_INSERT [dbo].[GLB_USUARIO] OFF